\documentclass[linenumbers,floatfix,ApJL,twocolumn]{aastex631}

\input{dfmstyle}
\input{dfmsymbols}
\input{custom_commands}

\shorttitle{The \tess\ Atlas}
\shortauthors{the authors}

\begin{document}

\title{The \tess\ Atlas: an open source catalog of TESS transit fits}

% ADS bibliography link
% https://ui.adsabs.harvard.edu/user/libraries/_DyLS4HbTY-eJIMBiFUdxw

\author{Author list TBD}
% \input{authors}





\begin{abstract}
We present the first \tess\ Atlas, a transiting exoplanet parameter estimate catalog generated from 2-minute cadence \tess\ data during 2018 through 2022 (Sectors 1 to 54).
This catalog contains posterior estimates for \red{\numAnalysed} \tess\ Objects of Interest, including \red{\numAnalysedMulti} multi-planet candidate systems and \red{\numAnalysedSingle} candidates with data for only a single transit.
Our analysis utilises the No-U-Turns Markov chain Monte Carlo algorithm to sample the parameter space with a circular transit model implemented in \exoplanet.
We compare the parameters from this catalog with those documented in ExoFOP.
We provide posterior samples from our analyses and Jupyter notebooks to reproduce the analyses for each exoplanet candidate.
\end{abstract}

% info on sectors: https://heasarc.gsfc.nasa.gov/docs/tess/sector.html

\keywords{%
  methods: data analysis ---
  methods: statistical ---
  miscellaneous --- catalogs --- surveys
}


\section{Introduction} \label{sec:intro}

In July 2020, NASA’s Transiting Exoplanet Survey Satellite \citep{Ricker:2015:JATIS} completed its two-year Primary Mission to search for transiting exoplanets around nearby bright stars.
\tess\ recorded 2-minute cadence observations for $\sim200,000$ pre-selected stars that were processed by the \tess\ Science Processing Operations Center \citep{Jenkins:2016:SPIE} pipeline.
Additionally, \tess\ also recorded measurements of its entire field of view in 10 and 30-minute sampled full-frame images (FFIs), enabling the flux measurements of tens of millions of stars.
Between 2, 10 and 30-minute observations, the \tess\ Primary Mission and the ongoing extended missions have identified over \red{$\numTessCandidates$} planet candidates, \red{$\numTessPlanets$} of which have been confirmed as planets \citep{Stassun:2018:AJ, Stassun:2019:AJ, Guerrero:2021:ApJS, Guerrero:2021:AAS}.
These candiates were found with two \tess\ Science office pipelines: the Science Processing Operations Center (SPOC) pipeline for the 2-minute cadence data, and the Quick Look Pipeline (QLP) for the 10 and 30-minute cadence data \citep{Guerrero:2021:ApJS}.
Some additional candidates were promoted with the help of community lead pipelines \citep{Guerrero:2021:ApJS}.
Furthermore, these pipelines were able to identify numerous non-exoplanet candidates in the \tess\ data disclosing new information on eclipsing binaries (e.g., ), tidally interacting systems (e.g., ), exomoons (e.g., ), comets (e.g., ),  exocoments (e.g., ), supernovae (e.g., ), and more (see [review] for more). \alltodo{get citations}.


The SPOC pipeline provides parameter estimates for candidates by using Mandel Agol (2002)'s geometric transit model, including a nonlinear limb-darkening model Claret Bloemen (2011).  the fitted parameters are determined with the iterative Levenberg-Marquardt (LM) algorithm (Levenberg 1944; Marquardt 1963).


TOIs which appear in several sectors accumulate more observations, which improve the determinations of period, epoch, and other parameters. The TOI catalog is therefore updated with parameters from the longest baseline of data for each TOI, with a preference for SPOC postage stamp data, largely due to its two-minute cadence and review process as the pipeline of record.

Given the different detrending and detection methods employed by the two different pipelines, we do not ex- pect the two pipelines to always detect the same signals in the same data. Of the 230 TOIs SPOC detected in Sectors 6-1318 with Tmag < 10.5 host stars, the QLP BLS detected 206. The QLP AstroNet triage (see Sec- tion 6.2) excluded 58 of these in automatic triage and visual triage rejected an additional 29 TCEs, giving a total of 119 TOIs detected by both SPOC and QLP.

Even though SPOC/TPS and QLP/BLS are not designed to search for single-transit events, they are occasionally detected when the transit happens to line up with either spurious noise events or to a data gap in the phase-folded light curves examined by TPS/BLS. We do include these sin- gle transit candidates in the TOI catalog, with the or- bital period parameter removed before release. If there is another transit of the candidate in a later sector, we update the TOI in the catalog with the correct period.

In this work we provide a catalog of transiting exoplanet posterior estimates for the \red{\numAnalysed} \tess\ Objects of Interest (TOIs) with 2-minute cadence observations from 2018 through 2022.
The posterior distributions provide robust uncertainties for the circular transit model's planet orbital timing parameters, stellar limb darkening, stellar density, mean flux and detector-noise parameters.
The posterior distributions can allow future researchers to study the planet population in detail and assess the reliability of the most Earth-like candidates, \alltodo{list more things that can be done}.

The remainder of the paper is organised as follows. Section~\ref{sec:method} describes our transit light curve model and the Bayesian framework we use to estimate parameters of exoplanet systems from the observed data.
The analysis results are summarised in Section~\ref{sec:results}.
The catalog, released data, and software to reproduce the results are described in Section~\ref{sec:data} and are available online as supplementary materials (\atlasUrl).
Finally, we provide concluding remarks in Section~\ref{sec:conclusion}.


\section{Method} \label{sec:method}


Targets are assigned consecutive TOI IDs. Multi- planet systems are assigned suffixes (.01, .02, etc.) mir- roring the suffixes assigned for the TCE. TEV automat- ically generates a comma-separated values (CSV) file with all necessary parameters for each TOI from the vetted TOI list. Each TOI comes with a table of pa- rameters, a DV summary page, and a full DV report.

TOI parameters reflect the best possible analysis available at the time of vetting.
We use this (same way SPOC uses the initial estimates from the previous stage)



\alltodo{TOI selection, lightcurve preprocessing, eccentricity posterior postprocessing}

\subsection{Transit light curve model}

There are many options for parameterisation of a transit, but we choose to model these transits as circular, non-interacting Keplerian orbits around their host star, parameterised by their observables.
We approximate the host star's stellar limb darkening profile using \citet{Kipping:2013:MNRAS}'s quadratic limb darkening law.
Finally, we compute the exoplanet's resultant quadratic limb-darkened transit lightcurve using an analytical model implemented in \starry.
The stellar variables in this model are parameterised by
the baseline relative flux of the light curve $f_0$,
the mean stellar density $\rho_\star$,
and two parameters describing the quadratic limb-darkening profile of the
star $u_1, u_2$.
To model stellar variability (e.g. asteroseismic oscillation of the star)  we use a Gaussian Process implemented in \celerite\ with a stochastically driven damped harmonic oscillator kernel in linear combination with a jitter term, to capture misspecified error bars and model misspecification. This requires three parameters: the quality factor $Q_{\rm GP}$, the undamped period of the oscillator $\rho_{\rm GP}$, the standard deviation of the process $\sigma_{\rm GP}$.

Each of the $n$ exoplanets in the system are parameterised by the planets'
\begin{enumerate}
  \item \emph{two reference transit times}, one near the beginning of the observations, $t_{\rm min}[n]$, and one near the end, $t_{\rm max}[n]$, measured in \tess\ BJD,
  \item \emph{the approximate transit depth}, $\delta[n]$, measured in parts-per-thousand,
  \item \emph{the impact parameter} of the orbit, $b[n]$, constrained to be $|b| \le 1$, and
  \item \emph{the transit duration}, $\tau[n]$, measured in hours,
  \item \emph{the radius ratio} $k[n]$ of the planet radius $R_{\rm p}[n]$ divided by the stellar radius $R_\star$.
\end{enumerate}
In the case when there are a planet has only a single transit present in the data, we use the planet's orbital period $P[n]$ in place of the second reference time $t_{\rm max}[n]$.
We also track the relevant Jacobians of the parameters. Some of these parameters are displayed in the schematic diagram in Figure~\ref{fig:schematic-transit-plot}.


\begin{figure}
  \includegraphics[width=\linewidth]{figures/transit_model.png}
  \caption{\textit{Schematic diagram of a transit light curve:} \alltodo{write some details about this plot}}
  \label{fig:schematic-transit-plot}
\end{figure}

More discussion of the details, motivations, and limitations of this transit parameterisation are presented below.

\paragraph{Transit times}
To speed up the analysis, we assume that the discovery period and phase of the orbit are close enough to the truth that we can fit only the data near the expected transit times.
One consequence of this assumption is that we are assuming that the \emph{number} of periods that occur in the \tess\ observational baseline is correct.
Practically, this means that our prior assumption is that the transits must occur within the data cutouts.
This can be difficult to enforce---especially for low signal-to-noise transits---but a good approximation can be achieved by fitting for two reference transit times, $t_{\rm min}$ and $t_{\rm max}$, with a fixed number of periods, $N_P$, between them, instead of a single reference time and the period.
Then we can compute the implied period as $P = (t_{\rm max} - t_{\rm min}) / N_P$.
Importantly this does not change the prior on $P$ and $t_0$ since the Jacobian is a constant $1/N_P$.

\paragraph{Transit depth}
It is worth spending a moment on the transit depth parameterisation.
This choice of parameterisation leads to efficient computation and convergence, but it comes with non-trivial shortcomings.
Since the physical parameter that is required to compute the light curve model is the radius ratio between the planet and the star $k = R_{\rm p} / R_\star$, we need to choose a parameterisation that is invertible and that isn't generally possible.
In some cases, using radius ratio directly as the parameter can work well, but \alltodo{explain cases where it's not}.
Instead, we choose to parameterise the approximate transit depth $\delta$ using the small planet approximation.
This is useful because it is directly invertible (conditioned on the limb darkening parameters and impact parameter), but it restricts us to considering non-grazing transits with impact parameter $|b| \le 1$.
Accepting this restriction, we can compute the approximate transit depth for a limb darkened light curve by assuming that the intensity of the star is uniform under the disk of the planet.
For quadratic limb darkening, the intensity profile is
\begin{equation}
  I(r) = 1 - u_1\,[1 - \mu(r)] - u_2\,[1 - \mu(r)]^2
\end{equation}
where $\mu(r) = \sqrt{1 - r^2}$.
The ratio of the occulted flux to the total stellar flux when the transit is deepest ($r = b$) is \citep[the same results are discussed by][]{Mandel:2002,Csizmadia:2013}
\begin{eqnarray}
  \delta &\approx& \frac{\int_0^k\,2\,\pi\,r\,I(b)\dd r}{\int_0^1\,2\,\pi\,r\,I(r)\dd r} \nonumber\\
  &=& \frac{k^2\,\left(1 - u_1\,[1 - \mu(b)] - u_2\,[1 - \mu(b)]^2\right)}{1 - u_1/3 - u_2/6}\quad.
\end{eqnarray}
Therefore, since $k$ must be positive, we have a one-to-one transformation between $\delta$ and $k$ conditioned on impact parameter $|b| \le 1$ and the limb darkening coefficients.
It is also important to include the Jacobian factor so that fitting in $\delta$ doesn't introduce a strange prior on $r$.
In this case, the relevant factor is
\begin{equation}
  \left|\frac{\dd k}{\dd \delta}\right| = \left|\frac{1 - u_1/3 - u_2/6}{2\,k\,\left(1 - u_1\,[1 - \mu(b)] - u_2\,[1 - \mu(b)]^2\right)}\right| \quad.
\end{equation}

\paragraph{Impact parameter}
Constrained to be non-grazing. -- \alltodo{Discuss the consequences of this.}

\paragraph{Transit duration}
The physical parameter required for computing the transit model is the semi-major axis, $a$, in units of the stellar radius, but the transit duration $\tau$ is better constrained so it can be better as a fit parameter.
For a circular orbit, the transit duration is \citep{Winn:2010}
\begin{equation}
  \tau = \frac{P}{\pi}\,\sin^{-1}\left( \frac{\sqrt{(1 + k^2) - b^2}}{a\,\sin i} \right) \quad.
\end{equation}
Rearranging this, we find
\begin{equation}
  a^2\,\sin^2 i\,\sin^2\left(\frac{\pi\,\tau}{P}\right) = (1 + k^2) - b^2 \quad.
\end{equation}
Then, using the fact that $\cos^2 i = b^2 / a^2$, we find
\begin{equation}
  a^2 = \frac{(1 + k)^2 - b^2\,\cos^2\phi}{\sin^2\phi}
\end{equation}
for $\phi = \pi\,\tau / P$.
And the Jacobian is
\begin{eqnarray}
  \frac{\dd a}{\dd \tau} &=& \frac{\pi\,\cos \phi}{a\,P\,\sin^3 \phi}\,\left[b^2 - (1 + k)^2\right] \quad.
\end{eqnarray}

Finally, from the period and semi-major axis, we can compute the implied stellar density (under this assumption of a circular orbit)
\begin{equation}
  \rho_\mathrm{circ} = \frac{3\,\pi\,a^3}{G\,P^2} \quad.
\end{equation}
It is important to note that this is not necessarily the same as the actual stellar density and that, in a multi-planet system, this implied density won't be the same for each planet \citep[see, for example,][]{Dawson:2012, Kipping:2012}.




\subsection{Bayesian Framework}


Likelihood, GP, Priors, \celerite, pymc3 sampling

%
%
%GPs are stochastic models consisting of a mean function
%$\mu_\vec{\theta}(\vec{x})$ and a covariance, autocorrelation, or ``kernel''
%function $K$ parameterized by
%$\vec{\theta}$ and $\vec{\alpha}$ respectively.
%Under this model, the log-likelihood function $\mathcal{L}
%(\vec{\theta},\,\vec{\alpha})$ with a dataset
%
%\begin{align}\eqlabel{gp-likelihood}
%\ln \mathcal{L} (\vec{\theta},\,\vec{\alpha})
%&= -\frac{1}{2} r(\vec{\theta})^{T}\, K(\vec{\alpha})^{-1}\, r(\vec{\theta}) \nonumber \\
%   -\frac{1}{2} \log \det K(\vec{\alpha})
%
%\end{align}






\section{Results}\label{sec:results}



\subsection{Systems with multiple planets}
Some words about these systems

\subsection{Planets with data for one transit}
Some stuff about single transit systems


\section{Data and software availability}\label{sec:data}

he DV module produces a one-page PDF summary report for each TCE, a PDF full report, and a PDF mini report for each target. The full report for each target with TCEs includes the results of all the tests along with diagnostic figures and run time warnings and errors. The mini-report for each target with TCEs combines the one-page summary along with the most informative diagnostic tests and graphics from the full report. An example one-page summary is shown in Figure 2. The DV module also produces a FITS file of the time series it analyzes as well as those presented in the diagnostic plots, and an XML file with numerical model fit and diagnostic test results (Tenenbaum  Jenkins 2018).

We provide software to reproduce the analyses and results at \atlasUrl.
The website contains one Jupyter notebook for each TOI, demonstrating the end-to-end analysis of a TOI.
The notebooks contain software to download and clean light curve data, implementations of the transit-model and priors for inference, the \pymc sampling stage, and a posterior post-processing step.
The website also documents the method to download our Bayesian parameter inference posterior samples, load them and make various plots.

\section{Discussion}\label{sec:conclusion}
We present for the first time a catalog of Bayesian posterior samples for the 2-minute cadence TOIs from 2018-2022.
Some words about results.
Some stuff about difficulty sampling grazing systems.
Errors when SPOC estimates are off.
We expect the remainder of the \tess\ extended mission will complete by September 2023, at which point an updated catalog will be produced.

Vetters can identify false positive TCEs by a few tell- tale signs: a visible secondary eclipse which cannot phys- ically be planetary in nature; a mismatch between odd and even transit depths caused by a stellar binary at twice the indicated period; a shift of the centroid to another nearby star; and increasing transit depth with aperture size, indicative that a signal is from an object nearby on the sky and not the suspected target star.

Lots of manual vetting requiured to promote TCE to TOI. In the future this work can help with that process.


\begin{acknowledgments}

We would like to thank xyz.
Ozgrav, Flatiron, NECTAR, ADACS, David Liptai
Work was started during `online.tess.science`

This work has made use of the TIC through the TESS Science Office’s target selection working group (architects K. Stassun, J. Pepper, N. De Lee, M. Paegert, R. Oelkers).

This research has made use of the NASA Exoplanet Archive, which is operated by the California Institute of Technology, under contract with the National Aeronautics and Space Administration under the Exoplanet Exploration Program.

This work made use of the \tess\ catalog on ExoFOP

Total compute time for this work \red{\cpuHrs} \alltodo{get more accurate compute time (this is an overestimate)}. CO$_2$ emission amount for this work would be XX, however as OzStar uses wind energy this has a negligible carbon footprint.

\end{acknowledgments}

\vspace{5mm}
\facilities{\tess, \gaia, \kepler, Exoplanet Archive, etc.}

\software{
astropy \citep{Astropy-Collaboration:2013,Astropy-Collaboration:2018},
exoplanet,
lightkurve,
starry,
celerite2,
pymc3,
numpy,
scipy,
pandas,
matplotlib,
corner,
sphinx,
}


\bibliography{atlas}{}
\bibliographystyle{aasjournal}

\end{document}
